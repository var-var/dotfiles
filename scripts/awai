#!/bin/bash

MAC="08:A3:0B:0A:61:82"
BLUEZ_CARD="bluez_card.08_A3_0B_0A_61_82"

case "$1" in
    on|connect)
        echo "üîå –ü–æ–¥–∫–ª—é—á–∞—é AWEI MUSIC..."
        bluetoothctl connect "$MAC" > /dev/null && \
        sleep 2 && \
        systemctl --user restart wireplumber pipewire pipewire-pulse && \
        sleep 3 && \
        pactl set-card-profile "$BLUEZ_CARD" a2dp_sink 2>/dev/null && \
        SINK_ID=$(wpctl status | grep "AWEI MUSIC" | head -1 | awk '{print $1}' | tr -d '‚óè') && \
        if [ -n "$SINK_ID" ]; then
            wpctl set-default "$SINK_ID"
            notify-send "üéß AWEI MUSIC" "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∏ –≤—ã–±—Ä–∞–Ω–æ –∫–∞–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤—ã–≤–æ–¥–∞" -i audio-headphones
            echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"
        else
            notify-send "‚ö†Ô∏è AWEI MUSIC" "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ, –Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∞—É–¥–∏–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö" -i dialog-warning
            echo "‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤ wpctl ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ plasma-pa"
        fi
        ;;
    off|disconnect)
        echo "üì¥ –û—Ç–∫–ª—é—á–∞—é AWEI MUSIC..."
        bluetoothctl disconnect "$MAC" > /dev/null && \
        notify-send "üéß AWEI MUSIC" "–û—Ç–∫–ª—é—á–µ–Ω–æ" -i audio-headphones
        ;;
    *)
        echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: awei [on|off]"
        exit 1
        ;;
esac
